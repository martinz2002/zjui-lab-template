% lab-report.sty
% Author: Martin Zhong
% Date: 2023/02/09
% Version: v2.3.3
% License: MIT
% Description: Report Template for ZJU-UIUC ECE course series. All Rights Reserved.

\def\VERSION{v2.3.3}
\def\RELEASEDATE{2023/02/09}

\ProvidesPackage{zjui-report}[\RELEASEDATE \VERSION by Martin Zhong (zhongmartin@outlook.com) Report Template for ZJU-UIUC ECE course series.]

\RequirePackage{kpfonts-otf}
\RequirePackage[scheme=plain]{ctex} % for Chinese support
\RequirePackage{booktabs}
\RequirePackage{indentfirst}
\RequirePackage{fancyhdr}
\RequirePackage{fontenc}
\RequirePackage{graphicx}
\RequirePackage{caption}
\RequirePackage{amsmath}  % for math spacing
\RequirePackage{lastpage}
\RequirePackage[top=2.54cm, bottom=2.54cm, left=3.18cm, right=3.18cm]{geometry} % page layout; same with the default of MS word
\RequirePackage{enumitem}
\RequirePackage{verbatim} % allows for verbatim text ignoring any TeX commands inside "verbatim" environment
\RequirePackage{listings}
\RequirePackage[dvipsnames]{xcolor}
\RequirePackage{hyperref}
\RequirePackage[ruled,hangingcomment,nofillcomment,noend]{algorithm2e}% pseudo-code support
\RequirePackage[en-US]{datetime2}
\RequirePackage[style=alphabetic,backend=bibtex]{biblatex}

\SetKwData{Null}{null}
\SetKwProg{Fn}{Function}{}{}
\SetKwProg{Proc}{Procedure}{}{}
\SetKw{Exit}{exit}
\SetKw{Call}{call}
\SetKwInOut{In}{input}
\SetKwInOut{Out}{output}
\SetKwData{True}{true}
\SetKwData{False}{false}

\lstset{ % General setup for the package
    basicstyle=\small\ttfamily,
    numbers=left,
    numberstyle=\scriptsize\ttfamily,
    frame=shadowbox,
    tabsize=4,
    breaklines,
    columns=fixed,
    keepspaces,
    commentstyle=\itshape\color{ForestGreen},
    keywordstyle=\color{blue}\bfseries,
}

\setenumerate{itemsep=0pt, partopsep=0pt, parsep=\parskip, topsep=5pt}
\setitemize{itemsep=0pt, partopsep=0pt, parsep=\parskip, topsep=5pt}
\setdescription{itemsep=0pt, partopsep=0pt, parsep=\parskip, topsep=5pt}

\renewcommand{\baselinestretch}{1.2} % 设置行距
\newcommand\CFOOTER{\scriptsize This PDF report is generated at \DTMnow.}
\everymath{\displaystyle}

\pagestyle{fancy}
\fancyhf{}
\fancyhead[C]{}
\fancyhead[L]{\RPTPREFIX~\RPTNUMBER}
\fancyhead[R]{\RPTDATE}
\fancyfoot[C]{--\thepage/\pageref{LastPage}-- \\ \CFOOTER}
\fancyfoot[L]{\COURSECODE}
\fancyfoot[R]{\SEMESTER}
% \renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

\newcommand{\E}{\text{e}}
\renewcommand{\Re}{\text{Re}}
\renewcommand{\Im}{\text{Im}}
\newcommand\K{\text{k}} % kilo = 1000
\newcommand\U[1]{\text{#1}} % for including units in equations

\fancypagestyle{contentpage}
{
\fancyhf{}
\fancyhead[C]{Contents}
\fancyhead[L]{\RPTPREFIX~\RPTNUMBER}
\fancyhead[R]{\RPTDATE}
\fancyfoot[C]{\CFOOTER}
\fancyfoot[L]{\COURSECODE}
\fancyfoot[R]{\SEMESTER}
}

\title{\textbf{\RPTPREFIX~\#\RPTNUMBER: \RPTTITLE}}
\date{}
\author{}
\def\RPTDATE{\DTMtoday} % default report date is "today"

\newcommand\reporttitle[3]{\def\RPTPREFIX{#1} \def\RPTNUMBER{#2} \def\RPTTITLE{#3}}
\newcommand\courseinfo[3]{\def\COURSECODE{#1} \def\COURSENAME{#2} \def\SEMESTER{#3}}
\newcommand\classsection[1]{\def\SECTION{#1}}
\newcommand\members[1]{\def\MEMBERS{#1}}
\newcommand\logo[1]{\def\PATHTOLOGO{#1}}

\newcommand\reportdate[3]{\def\RPTDATE{\DTMdisplaydate{#1}{#2}{#3}{0}}}

\newcommand\maketitlepage{
    \begin{titlepage}
        \centering

        \includegraphics[width=0.5\pagewidth]{\PATHTOLOGO}

        \vspace{2cm}

        {\Large\sf \COURSECODE: \COURSENAME}

        \vspace{1em}

        {\Large\sf \RPTPREFIX ~Report}

        \vfill

        {\huge\bfseries \RPTPREFIX ~\#\RPTNUMBER: \RPTTITLE}

        \vspace{3cm}

        {\MEMBERS}

        \vfill

        \begin{table}[h!]
            \centering\sf
            \begin{tabular}{r @{:\hspace{.5em}} l}
            Term           & \SEMESTER   \\
            Section        & \SECTION    \\
            Report Date    & \RPTDATE    \\
            \end{tabular}
        \end{table}

    \end{titlepage}

    \tableofcontents\thispagestyle{contentpage}\setcounter{page}{0}
    \pagebreak
    \maketitle
    \thispagestyle{fancy}
}

\AtEndDocument{\printbibliography}